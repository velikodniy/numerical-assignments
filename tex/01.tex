\section{\noindent Вычисление значений функций}

\noindent \textbf{Цель:} Изучить элементы теории погрешностей и исследовать
методы приближённого вычисления значений функций при помощи электронных
вычислительных машин.

\medskip{}



\subsubsection{Погрешности}

Любое отличие от верного ответа — это ошибка, вносящая в результат
некоторую погрешность. При решении практических задач с использованием
численных методов, ошибки неизбежны. Причём ошибки не обязательно
связаны с некачественным программным обеспечением или сбоями оборудования.
Часто причиной является неправильный выбор метода или вычисления без
учёта ограниченных возможностей вычислительной техники.

Выделяют следующие основные виды погрешностей.
\begin{itemize}
\item \emph{Неустранимая погрешность} — математическое описание задачи неточно,
т. е. либо неточны входные данные, либо неточна сама модель.
\item \emph{Погрешность метода} — метод не является точным, при его разработке
были сделаны какие-то допущения, приводящие к ошибке.
\item \emph{Вычислительная погрешность} — погрешности и ошибки в ходе расчётов.
\end{itemize}

\subsubsection{Виды погрешностей}

Сам факт наличия погрешности мало что говорит о качестве решения.
Погрешность может быть как приемлемой, так и недопустимой. Для того,
чтобы принимать решения о допустимости погрешностей необходимо уметь
оценивать их количественно. Качество результатов принято характеризовать
\emph{абсолютной} и \emph{относительной погрешностями}.

Пусть $x$ — точное значение, а $\tilde{x}$ — приближённое. Тогда:
\begin{itemize}
\item абсолютная погрешность: $\Delta x=|x-\tilde{x}|,$
\item относительная погрешность: $\delta x=\left|\frac{x-\tilde{x}}{\tilde{x}}\right|.$\end{itemize}
\begin{example}
При помощи некоторого численного метода решалось уравнение $x-3=0.$
Очевидно, точное решение этого уравнения — $x=3.$ При этом в качестве
результата было получено значение $\tilde{x}=3\z017.$ Тогда погрешности
будут равны
\begin{eqnarray*}
\Delta x & = & |3-3\z017|=0\z017=1\z7\times10^{-2},\\
\delta x & = & \left|\frac{3-3\z017}{3\z017}\right|\approx0\z00563=5\z663\times10^{-3}.
\end{eqnarray*}

\end{example}
\smallskip{}



\subsubsection{Свойства погрешностей}

При вычислении погрешностей можно пользоваться следующими свойствами:
\begin{eqnarray*}
\Delta(x_{1}+x_{2}) & = & \Delta x_{1}+\Delta x_{2},\\
\Delta(x_{1}-x_{2}) & = & \Delta x_{1}+\Delta x_{2},\\
\Delta(x_{1}x_{2}) & = & x_{1}\Delta x_{2}+x_{2}\Delta x_{1}.
\end{eqnarray*}


При более сложных вычислениях формулы существенно усложняются.

При сравнении погрешностей, полученных в результате решения различных
задач, используют относительную погрешность, так как она учитывает
масштаб величин. В самом деле, если производились вычисления над малыми
величинами, то и модуль их разности — абсолютная погрешность — будет
малой величиной, даже если величины значительно различаются.


\subsubsection{Оценка погрешностей}

Чтобы вычислить погрешность, необходимо знать точное значение величины,
что в большинстве случаев невозможно. Однако, погрешность часто можно
оценить исходя из свойств применямого метода или алгоритма вычислений.
При этом для записи погрешности обычно зависимости от параметра метода.
\begin{example}
Так называемый метод трапеций вычисления определённых интегралов имеет
параметр $h,$ определяющий точность вычислений. При этом погрешность
метода равна $O(h^{2}).$ $O$ — это не функция, а специальное математическое
обозначение.

По такой записи невозможно установить, чему равна погрешность для
конкретных значений $h.$ Однако, если строить график зависимости
погрешности от этого параметра, то он будет вести себя приблизительно
как парабола — график функции $h^{2}.$

Отсюда, в частности, следует, что если уменьшить $h$ в 10 раз, то
погрешность уменьшится в $10^{2}=100$ раз.
\end{example}
\smallskip{}


Если погрешность метода с некоторым малым параметром $h$ имеет вид
$O(h^{n}),$ то величина $n$ называется \emph{порядком точности}
численного метода. Чем она выше, тем лучше метод.

Очевидно, что величину погешности можно уменьшить, сведя количество
выполняемых вычислений к минимуму, так как каждое арифметическое действие
приводит к увеличению общей погрешности. Поэтому рекомендуется при
расчётах использовать экономные методы вычислений.


\subsubsection{Схема Горнера}

Например, для вычисления значений многочленов можно применять \emph{схему
Горнера}:
\begin{multline*}
a_{0}+a_{1}x+a_{2}x^{2}+a_{3}x^{3}+\ldots+a_{n}x^{n}=\\
=a_{0}+x\biggl(a_{1}+x\Bigl(a_{2}+\ldots+x\bigl(a_{n-1}+a_{n}x\bigr)\Bigr)\biggr).
\end{multline*}

\begin{example}
Рассмотрим вычисление по схеме Горнера многочлена третьей степени.
\[
2+3x+5x^{2}+6x^{3}=2+x(3+x(5+6x)).
\]


В правой части используется 6 умножений (с учётом умножений, необходимых
для возведения в степень) и 3 сложения. В левой части — 3 умножения
и 3 сложения.
\end{example}
\smallskip{}


Схему Горнера удобно реализовывать в виде цикла, выполняющего вычисления
начиная с самой внутренней скобки.


\subsubsection{Степенные ряды}

Степенным рядом называется бесконечная сумма вида
\[
f(x)=\sum_{k=0}^{\infty}a_{k}x^{k}.
\]


Ряды играют важную роль в численных методах, так как многие функции
можно представить в виде степенных рядов. Часто это единственный приемлемый
способ вычислить значение какой-либо функции. Например, функция $\sin x$
— трансцендентная, то есть её точные значения в различных невозможно
получить при помощи конечного числа арифметических операций.

Многие трансцендентные функции допускают разложение в \emph{ряд Тейлора}:
\begin{multline*}
f(x_{0}+\Delta x)=f(x_{0})+f'(x_{0})\Delta x+\frac{1}{2}f''(x_{0})\Delta x^{2}+\ldots=\\
=\sum_{k=0}^{\infty}\frac{f^{(k)}(x_{0})}{k!}\Delta x^{k}.
\end{multline*}


Таким образом, если известны значения функции и её производных в некоторой
точке $x_{0},$ то можно получить её значение в точке, удалённой от
$x_{0}$ на расстояние $\Delta x.$


\subsubsection{Сходимость степенного ряда}

Не все степенные ряды сходятся — то есть, их суммы равны конечному
числу для некоторого аргумента $x$. Например, бесконечная сумма (так
называемый гармонический ряд) 
\[
1+\frac{1}{2}+\frac{1}{3}+\frac{1}{4}+\dots
\]
неограниченно возрастает.

Некоторые ряды сходятся условно, то есть лишь для некоторых значений
$x$. 

??? про условие сходимости

??? скорость сходимости


\subsubsection{Вычисление рядов на ЭВМ}

???

Таким образом, алгоритм вычисления ряда 
\[
\sum_{k=0}^{\infty}a_{k}x^{k}
\]
принимает следующий вид.


%\Procname{$\proc{Суммирование ряда}$}
%
%\zi Вход: $x, \varepsilon$
%\zi Выход: $sum$
%
%\li $sum \gets 0$
%\li $k \gets 0$
%\li \Repeat
%       	$a \gets a_k x^k$
%\li		$sum \gets sum + a$
%\li		$k \gets k + 1$
%\li \Until $|a| \geqslant \varepsilon$



\subsection{Задание для самостоятельного выполнения}

Задачи:

Написать программу для приближённого вычисления значений заданной
функции при помощи разложения в ряд.

Сравнить результат с точным, вычислить абсолютную и относительную
погрешности.

Определить скорость сходимости.

Необходимо запрограммировать и исследовать следующие методы:

вычисление функций при помощи разложения в ряд (например, Тейлора).

При желании можно также реализовать:

какой-либо из ускорителей, например, ускоритель Эйлера.

В результатах должны быть представлены:
\begin{itemize}
\item точки, для которых вычислялась функция (4-5 штук);
\item задаваемые погрешности для критерия прекращения расчётов;
\item точные значения функций в выбранных точках;
\item вычисленные значения функции;
\item абсолютная и относительная погрешности;
\item количество итераций, потребовавшихся для получения результата.
\end{itemize}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline 
№ п/п & $x_{0}$ & $\varepsilon$ & $y$ & $y^{*}$ & $\Delta y$ & $\delta y$\tabularnewline
\hline 
\hline 
 &  &  &  &  &  & \tabularnewline
\hline 
\end{tabular}
\par\end{center}

В заключительной части нужно сделать выводы, дающие ответ на следующие
вопросы:
\begin{itemize}
\item Насколько разложение в ряд подходит для вычисления значений специальных
функций?
\item Велика ли погрешность?
\item От чего она зависит?
\item Как уменьшить погрешность вычислений?
\item От чего зависит скорость сходимости ряда? 
\end{itemize}
\begin{table}
\begin{centering}
\begin{tabular}{|c|c|c|c|}
\hline 
№ & $f(x)$ & Разложение в ряд & Условие сходимости\tabularnewline
\hline 
\hline 
0\vphantom{$\Biggl(\Biggr)$} & $\sin x$ & $\sum_{k=1}^{\infty}(-1)^{k-1}\frac{x^{2k-1}}{(2k-1)!}$ & $x\in\mathbb{R}$\tabularnewline
\hline 
1\vphantom{$\Biggl(\Biggr)$} & $\cos x$ & $\sum_{k=0}^{\infty}(-1)^{k}\frac{x^{2k}}{(2k)!}$ & $x\in\mathbb{R}$\tabularnewline
\hline 
2\vphantom{$\Biggl(\Biggr)$} & $\ln(1+x)$ & $\sum_{k=1}^{\infty}(-1)^{k-1}\frac{x^{k}}{k}$ & $x\in(-1,1]$\tabularnewline
\hline 
3\vphantom{$\Biggl(\Biggr)$} & $\mathrm{arctg}\, x$ & $\sum_{k=1}^{\infty}(-1)^{k-1}\frac{x^{2k-1}}{2k-1}$ & $x\in[-1,1]$\tabularnewline
\hline 
4\vphantom{$\Biggl(\Biggr)$} & $\mathrm{sh}\, x=\frac{e^{x}-e^{-x}}{2}$ & $\sum_{k=1}^{\infty}\frac{x^{2k-1}}{(2k-1)!}$ & $x\in\mathbb{R}$\tabularnewline
\hline 
5\vphantom{$\Biggl(\Biggr)$} & $\mathrm{ch}\, x=\frac{e^{x}+e^{-x}}{2}$ & $\sum_{k=0}^{\infty}\frac{x^{2k}}{(2k)!}$ & $x\in\mathbb{R}$\tabularnewline
\hline 
6\vphantom{$\Biggl(\Biggr)$} & $\ln\frac{1+x}{1-x}$ & $2\sum_{k=0}^{\infty}\frac{x^{2k-1}}{2k-1}$ & $x\in(-1,1)$\tabularnewline
\hline 
7\vphantom{$\Biggl(\Biggr)$} & $\frac{1}{1+x}$ & $\sum_{k=0}^{\infty}(-1)^{k}x^{k}$ & $x\in(-1,1)$\tabularnewline
\hline 
8\vphantom{$\Biggl(\Biggr)$} & $\frac{1}{(1-x)^{2}}$ & $\sum_{k=0}^{\infty}(k+1)x^{k}$ & $x\in(-1,1)$\tabularnewline
\hline 
9\vphantom{$\Biggl(\Biggr)$} & $e^{x}$ & $\sum_{k=0}^{\infty}\frac{x^{k}}{k!}$ & $x\in\mathbb{R}$\tabularnewline
\hline 
\end{tabular}
\par\end{centering}

\caption{Варианты заданий}
\end{table}



\subsection{Вопросы для самоконтроля}

